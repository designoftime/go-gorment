import{r as d,S as oe,u as de,j as e,d as x,L as y}from"./index-95426e20.js";import{S as ce,I as me}from"./Layout-bff97c17.js";import{C as pe,S as xe}from"./BulkActionDrawer-80bde22c.js";import{C as z,T as ee,D as ge,u as ue,M as he}from"./DrawerButton-27e60233.js";import{D as je,E as be}from"./EditDeleteButton-d95357e6.js";import{T as fe}from"./ParentCategory-a24524a0.js";import{a as K,n as se}from"./toast-0102ee3b.js";import{u as Ne,E as $}from"./index.esm-d6590509.js";import{I as Q}from"./InputArea-6b8d54ee.js";import{L as j}from"./LabelArea-a1d14b65.js";import{T as ve,S as Se}from"./TextAreaCom-3171e496.js";import{U as B}from"./Uploader-3591a674.js";import{u as Te}from"./useTranslationValue-97298952.js";import{u as ae}from"./useUtilsFunction-41e1aa5a.js";const Ce=(o,g)=>{const{isDrawerOpen:r,closeDrawer:f,setIsUpdate:c,lang:_}=d.useContext(oe),[N,v]=d.useState({}),[C,I]=d.useState(""),[D,u]=d.useState(""),[A,s]=d.useState(""),[b,S]=d.useState(""),[p,H]=d.useState(""),[P,F]=d.useState(""),[O,M]=d.useState([]),[n,k]=d.useState(_),[R,w]=d.useState(!0),[E,L]=d.useState(""),[V,U]=d.useState(!1),{handlerTextTranslateHandler:q}=Te(),{register:l,handleSubmit:h,setValue:a,clearErrors:m,reset:Y,formState:{errors:le}}=Ne(),re=async({name:i,description:t,background_color:ne,text_color:ie})=>{var W,X;try{U(!0);const T=await q(i,n),G=await q(t,n),Z={name:{[n]:i,...T},description:{[n]:t||"",...G},background_color:{[n]:ne||"",...G},text_color:{[n]:ie||"",...G},parentId:C||void 0,parentName:E||"Home",icon:D,icon1:A,icon2:b,icon3:p,icon4:P,status:R?"show":"hide",lang:n};if(o){const J=await z.updateCategory(o,Z);c(!0),U(!1),se(J.message),f(),Y()}else{const J=await z.addCategory(Z);c(!0),U(!1),se(J.message),f()}}catch(T){U(!1),K(T?(X=(W=T==null?void 0:T.response)==null?void 0:W.data)==null?void 0:X.message:T==null?void 0:T.message),f()}},te=i=>{k(i),Object.keys(N).length>0&&(a("name",N.name[i||"en"]),a("description",N.description[i||"en"]),a("background_color",N.background_color[i||"en"]),a("text_color",N.text_color[i||"en"]))};return d.useEffect(()=>{var i;if(!r){v({}),a("name"),a("parentId"),a("parentName"),a("description"),a("background_color"),a("text_color"),a("icon"),a("icon1"),a("icon2"),a("icon3"),a("icon4"),u(""),w(!0),m("name"),m("parentId"),m("parentName"),m("description"),m("background_color"),m("text_color"),L("Home"),k(_),a("language",n),g!==void 0&&((i=g[0])==null?void 0:i._id)!==void 0&&I(g[0]._id);return}o&&(async()=>{try{const t=await z.getCategoryById(o);t&&(v(t),a("name",t.name[n||"en"]),a("description",t.description[n||"en"]),a("language",n),a("parentId",t.parentId),a("parentName",t.parentName),a("background_color",t.background_color.en),a("text_color",t.text_color.en.en),L(t.parentName),I(t.parentId),u(t.icon),s(t.icon1),S(t.icon2),H(t.icon3),F(t.icon4),w(t.status==="show"))}catch(t){K(t?t.response.data.message:t.message)}})()},[o,a,r,n,m,g,_]),{register:l,handleSubmit:h,onSubmit:re,errors:le,imageUrl:D,imageUrl1:A,imageUrl2:b,imageUrl3:p,imageUrl4:P,setImageUrl:u,setImageUrl1:s,setImageUrl2:S,setImageUrl3:H,setImageUrl4:F,children:O,setChildren:M,published:R,setPublished:w,checked:C,setChecked:I,isSubmitting:V,selectCategoryName:E,setSelectCategoryName:L,handleSelectLanguage:te}},Ue=({id:o,data:g})=>{const{t:r}=de(),{checked:f,register:c,onSubmit:_,handleSubmit:N,errors:v,imageUrl:C,imageUrl1:I,imageUrl2:D,imageUrl3:u,imageUrl4:A,setImageUrl:s,setImageUrl1:b,setImageUrl2:S,setImageUrl3:p,setImageUrl4:H,published:P,setPublished:F,setChecked:O,selectCategoryName:M,setSelectCategoryName:n,handleSelectLanguage:k,isSubmitting:R}=Ce(o,g),{showingTranslateValue:w}=ae(),E=`
  .rc-tree-child-tree {
    display: hidden;
  }
  .node-motion {
    transition: all .3s;
    overflow-y: hidden;
  }
`,L={motionName:"node-motion",motionAppear:!1,onAppearStart:l=>({height:0}),onAppearActive:l=>({height:l.scrollHeight}),onLeaveStart:l=>({height:l.offsetHeight}),onLeaveActive:()=>({height:0})},V=l=>{let h=[];for(let a of l)h.push({title:w(a.name),key:a._id,children:a.children.length>0&&V(a.children)});return h},U=(l,h)=>{var a;return l._id===h?l:(a=l==null?void 0:l.children)==null?void 0:a.reduce((m,Y)=>m??U(Y,h),void 0)},q=async l=>{if(l!==void 0)if(o){const h=await z.getCategoryById(l);if(o===l)return K("This can't be select as a parent category!");if(o===h.parentId)return K("This can't be select as a parent category!");{if(l===void 0)return;O(l);const a=g[0],m=U(a,l);n(w(m==null?void 0:m.name))}}else{if(l===void 0)return;O(l);const h=g[0],a=U(h,l);n(w(a==null?void 0:a.name))}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full relative p-6 border-b border-gray-100 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:o?e.jsx(ee,{register:c,handleSelectLanguage:k,title:r("UpdateCategory"),description:r("UpdateCategoryDescription")}):e.jsx(ee,{register:c,handleSelectLanguage:k,title:r("AddCategoryTitle"),description:r("AddCategoryDescription")})}),e.jsx(ce,{className:"w-full md:w-7/12 lg:w-8/12 xl:w-8/12 relative dark:bg-gray-700 dark:text-gray-200",children:e.jsxs("form",{onSubmit:N(_),children:[e.jsxs("div",{className:"p-6 flex-grow scrollbar-hide w-full max-h-full pb-40",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(j,{label:r("Name")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(Q,{register:c,label:"Category title",name:"name",type:"text",placeholder:r("ParentCategoryPlaceholder")}),e.jsx($,{errorName:v.name})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(j,{label:r("Description")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(ve,{required:!0,register:c,label:"Description",name:"description",type:"text",placeholder:"Category Description"}),e.jsx($,{errorName:v.description})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(j,{label:r("ParentCategory")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4 relative",children:[e.jsx(x.Input,{readOnly:!0,...c("parent",{required:!1}),name:"parent",value:M||"Home",placeholder:r("ParentCategory"),type:"text"}),e.jsxs("div",{className:"draggable-demo capitalize",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:E}}),e.jsx(fe,{expandAction:"click",treeData:V(g),selectedKeys:[f],onSelect:l=>q(l[0]),motion:L,animation:"slide-up"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(j,{label:r("CategoryIcon")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(B,{imageUrl:C,setImageUrl:s,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(j,{label:"Testimonial One"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(B,{imageUrl:I,setImageUrl:b,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(j,{label:"Testimonial Two"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(B,{imageUrl:D,setImageUrl:S,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(j,{label:"Testimonial Three"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(B,{imageUrl:u,setImageUrl:p,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(j,{label:"Testimonial Four"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(B,{imageUrl:A,setImageUrl:H,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(j,{label:"Background Color"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(Q,{register:c,label:"Background Color",name:"background_color",type:"text",placeholder:"Background Color"}),e.jsx($,{errorName:v.background_color})]})]})," ",e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(j,{label:"Text Color"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(Q,{register:c,label:"Text Color",name:"text_color",type:"text",placeholder:"Text Color"}),e.jsx($,{errorName:v.text_color})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(j,{label:r("Published")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(Se,{handleProcess:F,processOption:P})})]})]}),e.jsx(ge,{id:o,title:"Category",isSubmitting:R})]})})]})},Re=({data:o,lang:g,isCheck:r,categories:f,setIsCheck:c,useParamId:_,showChild:N})=>{const{title:v,serviceId:C,handleModalOpen:I,handleUpdate:D}=ue(),{showingTranslateValue:u}=ae(),A=s=>{const{id:b,checked:S}=s.target;c([...r,b]),S||c(r.filter(p=>p!==b))};return e.jsxs(e.Fragment,{children:[(r==null?void 0:r.length)<1&&e.jsx(je,{useParamId:_,id:C,title:v}),e.jsx(he,{children:e.jsx(Ue,{id:C,data:o,lang:g})}),e.jsx(x.TableBody,{children:f==null?void 0:f.map(s=>{var b,S;return e.jsxs(x.TableRow,{children:[e.jsx(x.TableCell,{children:e.jsx(pe,{type:"checkbox",name:"category",id:s._id,handleClick:A,isChecked:r==null?void 0:r.includes(s._id)})}),e.jsx(x.TableCell,{className:"font-semibold uppercase text-xs",children:(b=s==null?void 0:s._id)==null?void 0:b.substring(20,24)}),e.jsx(x.TableCell,{children:s!=null&&s.icon?e.jsx(x.Avatar,{className:"hidden mr-3 md:block bg-gray-50 p-1",src:s==null?void 0:s.icon,alt:s==null?void 0:s.parent}):e.jsx(x.Avatar,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product",className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none"})}),e.jsx(x.TableCell,{className:"font-medium text-sm ",children:(s==null?void 0:s.children.length)>0?e.jsxs(y,{to:`/categories/${s==null?void 0:s._id}`,className:"text-blue-700",children:[u(s==null?void 0:s.name),e.jsx(e.Fragment,{children:N&&e.jsxs(e.Fragment,{children:[" ",e.jsx("div",{className:"pl-2 ",children:(S=s==null?void 0:s.children)==null?void 0:S.map(p=>e.jsx("div",{children:e.jsx(y,{to:`/categories/${p==null?void 0:p._id}`,className:"text-blue-700",children:e.jsxs("div",{className:"flex text-xs items-center  text-blue-800",children:[e.jsx("span",{className:" text-xs text-gray-500 pr-1",children:e.jsx(me,{})}),e.jsx("span",{className:"text-gray-500",children:u(p.name)})]})})},p._id))})]})})]}):e.jsx("span",{children:u(s==null?void 0:s.name)})}),e.jsx(x.TableCell,{className:"text-sm",children:u(s==null?void 0:s.description)}),e.jsx(x.TableCell,{className:"text-center",children:e.jsx(xe,{id:s._id,category:!0,status:s.status})}),e.jsx(x.TableCell,{children:e.jsx(be,{id:s==null?void 0:s._id,parent:s,isCheck:r,children:s==null?void 0:s.children,handleUpdate:D,handleModalOpen:I,title:u(s==null?void 0:s.name)})})]},s._id)})})]})};export{Ue as C,Re as a};
