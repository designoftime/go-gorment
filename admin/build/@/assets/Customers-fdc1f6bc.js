import{r as b,S as k,j as e,d as s,L as v,t as T,u as A}from"./index-b7a5549d.js";import{U as F}from"./UploadManyTwo-9d63c683.js";import{d as M}from"./index-3dfa6e17.js";import{S as P,h as U}from"./Layout-f2a02bb8.js";import{T as S,D as B,M as R}from"./DrawerButton-b9b70d23.js";import{D as z,E as H}from"./EditDeleteButton-4d689b9f.js";import{u as L}from"./themeServices-4cc20a2b.js";import{T as D}from"./Tooltip-1cb23d0e.js";import{u as _,E as f}from"./index.esm-3774b945.js";import{I as y}from"./InputArea-b4aac65e.js";import{L as C}from"./LabelArea-03aa42f0.js";import{C as w}from"./CustomerServices-5f73556c.js";import{a as E,n as O}from"./toast-03090123.js";import{G as V}from"./iconBase-4887631a.js";import{T as Y}from"./TableLoading-3bafd42b.js";import{N as q}from"./NotFound-aab8acd4.js";import{P as G}from"./PageTitle-800b2fce.js";import{u as $}from"./SettingServices-7f7a0dde.js";import{u as J}from"./useFilter-d1e31a51.js";import"./exportFromJSON-59a1cb7c.js";import"./spinner-f39505bc.js";import"./SelectLanguageTwo-f9b2e648.js";import"./LanguageServices-74d9215e.js";import"./httpService-f80adca5.js";import"./AdminServices-03b8c083.js";import"./CurrencyServices-a77033de.js";import"./browser-f394fd76.js";import"./useUtilsFunction-3ede5aec.js";const Z=r=>{const[i,n]=b.useState(""),[c,t]=b.useState(!1),{closeDrawer:a,setIsUpdate:h}=b.useContext(k),{register:g,handleSubmit:j,setValue:x,formState:{errors:N}}=_(),u=async m=>{var p,l;try{t(!0);const d={name:m.name,email:m.email,phone:m.phone,address:m.address};if(r){const o=await w.updateCustomer(r,d);h(!0),O(o.message),a()}t(!1)}catch(d){E(d?(l=(p=d==null?void 0:d.response)==null?void 0:p.data)==null?void 0:l.message:d.message),a()}};return b.useEffect(()=>{r&&(async()=>{var m,p;try{const l=await w.getCustomerById(r);l&&(x("name",l.name),x("phone",l.phone),x("email",l.email),x("address",l.address))}catch(l){E(l?(p=(m=l==null?void 0:l.response)==null?void 0:m.data)==null?void 0:p.message:l.message)}})()},[r,x]),{register:g,handleSubmit:j,onSubmit:u,errors:N,setImageUrl:n,imageUrl:i,isSubmitting:c}},K=({id:r})=>{const{register:i,handleSubmit:n,onSubmit:c,errors:t,isSubmitting:a}=Z(r);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full relative p-6 border-b border-gray-100 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:r?e.jsx(S,{title:"Update Customer",description:"Update your Customer necessary information from here"}):e.jsx(S,{title:"Add Customer",description:"Add your Customer necessary information from here"})}),e.jsx(P,{className:"w-full md:w-7/12 lg:w-8/12 xl:w-8/12 relative dark:bg-gray-700 dark:text-gray-200",children:e.jsxs("form",{onSubmit:n(c),children:[e.jsxs("div",{className:"px-6 pt-8 flex-grow scrollbar-hide w-full max-h-full pb-40",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(C,{label:"Name"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(y,{register:i,label:"Name",name:"name",type:"text",placeholder:"Name"}),e.jsx(f,{errorName:t.name})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(C,{label:"Email"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(y,{register:i,label:"Email",name:"email",type:"email",placeholder:"Email"}),e.jsx(f,{errorName:t.email})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(C,{label:"Phone"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(y,{required:!0,register:i,label:"Phone",name:"phone",type:"text",placeholder:"Phone"}),e.jsx(f,{errorName:t.phone})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(C,{label:"Address"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(y,{required:!0,register:i,label:"Address",name:"address",type:"text",placeholder:"Address"}),e.jsx(f,{errorName:t.address})]})]})]}),e.jsx(B,{id:r,title:"Customer",isSubmitting:a})]})})]})};function Q(r){return V({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"}},{tag:"path",attr:{d:"M4 6h16v2H4zm2-4h12v2H6zm14 8H4c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2zm0 10H4v-8h16v8zm-10-7.27v6.53L16 16z"}}]})(r)}const W=({customers:r})=>{const{title:i,serviceId:n,handleModalOpen:c,handleUpdate:t}=L();return e.jsxs(e.Fragment,{children:[e.jsx(z,{id:n,title:i}),e.jsx(R,{children:e.jsx(K,{id:n})}),e.jsx(s.TableBody,{children:r==null?void 0:r.map(a=>{var h,g;return e.jsxs(s.TableRow,{children:[e.jsx(s.TableCell,{children:e.jsxs("span",{className:"font-semibold uppercase text-xs",children:[" ",(h=a==null?void 0:a._id)==null?void 0:h.substring(20,24)]})}),e.jsx(s.TableCell,{children:e.jsx("span",{className:"text-sm",children:M(a.createdAt).format("MMM D, YYYY")})}),e.jsx(s.TableCell,{children:e.jsx("span",{className:"text-sm",children:a.name})}),e.jsxs(s.TableCell,{children:[e.jsx("span",{className:"text-sm",children:a.email})," "]}),e.jsx(s.TableCell,{children:e.jsx("span",{className:"text-sm font-medium",children:e.jsx(s.Badge,{type:"success",children:(g=a==null?void 0:a.subscriptionType)!=null&&g.find(j=>j.status==="Active")?"Subscribed":"Unsubscribed"})})}),e.jsx(s.TableCell,{children:e.jsxs("div",{className:"flex justify-end text-right",children:[e.jsxs("div",{className:"p-2 cursor-pointer text-gray-400 hover:text-emerald-600",children:[" ",e.jsx(v,{to:`/customer-subscription-order/${a._id}`,children:e.jsx(D,{id:"view",Icon:Q,title:T("ViewOrder"),bgColor:"#34D399"})})]}),e.jsxs("div",{className:"p-2 cursor-pointer text-gray-400 hover:text-emerald-600",children:[" ",e.jsx(v,{to:`/customer-order/${a._id}`,children:e.jsx(D,{id:"view",Icon:U,title:T("ViewOrder"),bgColor:"#34D399"})})]}),e.jsx(H,{title:a.name,id:a._id,handleUpdate:t,handleModalOpen:c})]})})]},a._id)})})]})},De=()=>{const{data:r,loading:i,error:n}=$(w.getAllCustomers),{userRef:c,dataTable:t,serviceData:a,filename:h,isDisabled:g,setSearchUser:j,totalResults:x,resultsPerPage:N,handleSubmitUser:u,handleSelectFile:m,handleChangePage:p,handleUploadMultiple:l,handleRemoveSelectFile:d}=J(r),{t:o}=A(),I=()=>{j(""),c.current.value=""};return e.jsxs(e.Fragment,{children:[e.jsx(G,{children:o("CustomersPage")}),e.jsx(s.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5",children:e.jsx(s.CardBody,{children:e.jsx("form",{onSubmit:u,className:"py-3 grid gap-4 lg:gap-6 xl:gap-6 md:flex xl:flex",children:e.jsx("div",{className:"items-center",children:e.jsx(F,{title:"Customers",exportData:r,filename:h,isDisabled:g,handleSelectFile:m,handleUploadMultiple:l,handleRemoveSelectFile:d})})})})}),e.jsx(s.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5",children:e.jsx(s.CardBody,{children:e.jsxs("form",{onSubmit:u,className:"py-3 grid gap-4 lg:gap-6 xl:gap-6 md:flex xl:flex",children:[e.jsxs("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx(s.Input,{ref:c,type:"search",name:"search",placeholder:o("CustomersPageSearchPlaceholder")}),e.jsx("button",{type:"submit",className:"absolute right-0 top-0 mt-5 mr-1"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx("div",{className:"w-full mx-1",children:e.jsx(s.Button,{type:"submit",className:"h-12 w-full bg-emerald-700",children:"Filter"})}),e.jsx("div",{className:"w-full mx-1",children:e.jsx(s.Button,{layout:"outline",onClick:I,type:"reset",className:"px-4 md:py-1 py-2 h-12 text-sm dark:bg-gray-700",children:e.jsx("span",{className:"text-black dark:text-gray-200",children:"Reset"})})})]})]})})}),i?e.jsx(Y,{row:12,col:6,width:190,height:20}):n?e.jsx("span",{className:"text-center mx-auto text-red-500",children:n}):(a==null?void 0:a.length)!==0?e.jsxs(s.TableContainer,{className:"mb-8",children:[e.jsxs(s.Table,{children:[e.jsx(s.TableHeader,{children:e.jsxs("tr",{children:[e.jsx(s.TableCell,{children:o("CustomersId")}),e.jsx(s.TableCell,{children:o("CustomersJoiningDate")}),e.jsx(s.TableCell,{children:o("CustomersName")}),e.jsx(s.TableCell,{children:o("CustomersEmail")}),e.jsx(s.TableCell,{children:o("Subscription")}),e.jsx(s.TableCell,{className:"text-right",children:o("CustomersActions")})]})}),e.jsx(W,{customers:t})]}),e.jsx(s.TableFooter,{children:e.jsx(s.Pagination,{totalResults:x,resultsPerPage:N,onChange:p,label:"Table navigation"})})]}):e.jsx(q,{title:"Sorry, There are no customers right now."})]})};export{De as default};
