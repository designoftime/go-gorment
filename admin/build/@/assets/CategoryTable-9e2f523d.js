import{r as o,S as me,u as pe,j as e,d as x,L as se}from"./index-78e5a7da.js";import{S as ge,I as xe}from"./Layout-f51d96ed.js";import{C as ue,S as he}from"./BulkActionDrawer-1ecd107a.js";import{C as G,u as be}from"./themeServices-015c1982.js";import{D as je,E as fe}from"./EditDeleteButton-063bf72c.js";import{T as ae,D as ve,M as Ne}from"./DrawerButton-8e52fdc2.js";import{T as Se}from"./ParentCategory-dfd11178.js";import{a as J,n as le}from"./toast-2b207009.js";import{u as _e,E as O}from"./index.esm-8bbccf9c.js";import{I as Y}from"./InputArea-0ed39232.js";import{L as p}from"./LabelArea-b34538a6.js";import{S as Ce}from"./SwitchToggle-a60e0a2b.js";import{T as Ue}from"./TextAreaCom-a2f0d7ac.js";import{U as k}from"./Uploader-0db1a3f7.js";import{u as Te}from"./useTranslationValue-697c0d2d.js";import{u as re}from"./useUtilsFunction-bbcb56ad.js";const Ie=(d,u)=>{const{isDrawerOpen:t,closeDrawer:_,setIsUpdate:c,lang:T}=o.useContext(me),[j,f]=o.useState({}),[C,I]=o.useState(""),[D,h]=o.useState(""),[A,s]=o.useState(""),[v,N]=o.useState(""),[g,E]=o.useState(""),[M,L]=o.useState(""),[q,B]=o.useState(""),[R,V]=o.useState([]),[n,H]=o.useState(T),[$,w]=o.useState(!0),[P,F]=o.useState(""),[z,U]=o.useState(!1),{handlerTextTranslateHandler:K}=Te(),{register:l,handleSubmit:b,setValue:a,clearErrors:m,reset:Q,formState:{errors:te}}=_e(),ne=async({name:i,description:r,background_color:oe,text_color:de,sub_title:ce})=>{var Z,y;try{U(!0);const S=await K(i,n),W=await K(r,n),ee={name:{[n]:i,...S},sub_title:{[n]:ce,...S},description:{[n]:r||"",...W},background_color:{[n]:oe||"",...W},text_color:{[n]:de||"",...W},parentId:C||void 0,parentName:P||"Home",cover:A,icon:D,icon1:v,icon2:g,icon3:M,icon4:q,status:$?"show":"hide",lang:n};if(d){const X=await G.updateCategory(d,ee);c(!0),U(!1),le(X.message),_(),Q()}else{const X=await G.addCategory(ee);c(!0),U(!1),le(X.message),_()}}catch(S){U(!1),J(S?(y=(Z=S==null?void 0:S.response)==null?void 0:Z.data)==null?void 0:y.message:S==null?void 0:S.message),_()}},ie=i=>{H(i),Object.keys(j).length>0&&(a("name",j.name[i||"en"]),a("description",j.description[i||"en"]),a("background_color",j.background_color[i||"en"]),a("text_color",j.text_color[i||"en"]),a("sub_title",j.sub_title[i||"en"]))};return o.useEffect(()=>{var i;if(!t){f({}),a("name"),a("sub_title"),a("parentId"),a("parentName"),a("description"),a("background_color"),a("text_color"),a("icon"),a("cover"),a("icon1"),a("icon2"),a("icon3"),a("icon4"),h(""),s(""),N(""),E(""),L(""),B(""),w(!0),m("name"),m("sub_title"),m("parentId"),m("parentName"),m("description"),m("background_color"),m("text_color"),F("Home"),H(T),a("language",n),u!==void 0&&((i=u[0])==null?void 0:i._id)!==void 0&&I(u[0]._id);return}d&&(async()=>{try{const r=await G.getCategoryById(d);console.log(r),r&&(f(r),a("name",r.name[n||"en"]),a("sub_title",r.sub_title[n||"en"]),a("description",r.description[n||"en"]),a("language",n),a("parentId",r.parentId),a("parentName",r.parentName),a("background_color",r.background_color[n||"en"]),a("text_color",r.text_color[n||"en"]),F(r.parentName),I(r.parentId),h(r.icon),s(r.cover),N(r.icon1),E(r.icon2),L(r.icon3),B(r.icon4),w(r.status==="show"))}catch(r){J(r?r.response.data.message:r.message)}})()},[d,a,t,n,m,u,T]),{register:l,handleSubmit:b,onSubmit:ne,errors:te,imageUrl:D,imageUrlCover:A,setImageUrlCover:s,imageUrl1:v,imageUrl2:g,imageUrl3:M,imageUrl4:q,setImageUrl:h,setImageUrl1:N,setImageUrl2:E,setImageUrl3:L,setImageUrl4:B,children:R,setChildren:V,published:$,setPublished:w,checked:C,setChecked:I,isSubmitting:z,selectCategoryName:P,setSelectCategoryName:F,handleSelectLanguage:ie}},we=({id:d,data:u})=>{const{t}=pe(),{checked:_,register:c,onSubmit:T,handleSubmit:j,errors:f,imageUrlCover:C,imageUrl:I,imageUrl1:D,imageUrl2:h,imageUrl3:A,imageUrl4:s,setImageUrl:v,setImageUrlCover:N,setImageUrl1:g,setImageUrl2:E,setImageUrl3:M,setImageUrl4:L,published:q,setPublished:B,setChecked:R,selectCategoryName:V,setSelectCategoryName:n,handleSelectLanguage:H,isSubmitting:$}=Ie(d,u),{showingTranslateValue:w}=re(),P=`
  .rc-tree-child-tree {
    display: hidden;
  }
  .node-motion {
    transition: all .3s;
    overflow-y: hidden;
  }
`,F={motionName:"node-motion",motionAppear:!1,onAppearStart:l=>({height:0}),onAppearActive:l=>({height:l.scrollHeight}),onLeaveStart:l=>({height:l.offsetHeight}),onLeaveActive:()=>({height:0})},z=l=>{let b=[];for(let a of l)b.push({title:w(a.name),key:a._id,children:a.children.length>0&&z(a.children)});return b},U=(l,b)=>{var a;return l._id===b?l:(a=l==null?void 0:l.children)==null?void 0:a.reduce((m,Q)=>m??U(Q,b),void 0)},K=async l=>{if(l!==void 0)if(d){const b=await G.getCategoryById(l);if(d===l)return J("This can't be select as a parent category!");if(d===b.parentId)return J("This can't be select as a parent category!");{if(l===void 0)return;R(l);const a=u[0],m=U(a,l);n(w(m==null?void 0:m.name))}}else{if(l===void 0)return;R(l);const b=u[0],a=U(b,l);n(w(a==null?void 0:a.name))}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full relative p-6 border-b border-gray-100 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:d?e.jsx(ae,{register:c,handleSelectLanguage:H,title:t("UpdateCategory"),description:t("UpdateCategoryDescription")}):e.jsx(ae,{register:c,handleSelectLanguage:H,title:t("AddCategoryTitle"),description:t("AddCategoryDescription")})}),e.jsx(ge,{className:"w-full md:w-7/12 lg:w-8/12 xl:w-8/12 relative dark:bg-gray-700 dark:text-gray-200",children:e.jsxs("form",{onSubmit:j(T),children:[e.jsxs("div",{className:"p-6 flex-grow scrollbar-hide w-full max-h-full pb-40",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(p,{label:t("Name")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(Y,{register:c,label:"Category title",name:"name",type:"text",placeholder:t("ParentCategoryPlaceholder")}),e.jsx(O,{errorName:f.name})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(p,{label:"Sub title"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(Y,{register:c,label:"Sub title",name:"sub_title",type:"text",placeholder:"Sub title"}),e.jsx(O,{errorName:f.sub_title})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(p,{label:t("Description")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(Ue,{required:!0,register:c,label:"Description",name:"description",type:"text",placeholder:"Category Description"}),e.jsx(O,{errorName:f.description})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(p,{label:t("ParentCategory")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4 relative",children:[e.jsx(x.Input,{readOnly:!0,...c("parent",{required:!1}),name:"parent",value:V||"Home",placeholder:t("ParentCategory"),type:"text"}),e.jsxs("div",{className:"draggable-demo capitalize",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:P}}),e.jsx(Se,{expandAction:"click",treeData:z(u),selectedKeys:[_],onSelect:l=>K(l[0]),motion:F,animation:"slide-up"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(p,{label:t("CategoryIcon")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(k,{imageUrl:I,setImageUrl:v,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(p,{label:"Cover Image"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(k,{imageUrl:C,setImageUrl:N,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(p,{label:"Testimonial One"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(k,{imageUrl:D,setImageUrl:g,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(p,{label:"Testimonial Two"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(k,{imageUrl:h,setImageUrl:E,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(p,{label:"Testimonial Three"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(k,{imageUrl:A,setImageUrl:M,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(p,{label:"Testimonial Four"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(k,{imageUrl:s,setImageUrl:L,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(p,{label:"Background Color"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(Y,{register:c,required:!0,label:"Background Color",name:"background_color",type:"text",placeholder:"Background Color"}),e.jsx(O,{errorName:f.background_color})]})]})," ",e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(p,{label:"Text Color"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(Y,{register:c,required:!0,label:"Text Color",name:"text_color",type:"text",placeholder:"Text Color"}),e.jsx(O,{errorName:f.text_color})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(p,{label:t("Published")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(Ce,{handleProcess:B,processOption:q})})]})]}),e.jsx(ve,{id:d,title:"Category",isSubmitting:$})]})})]})},Ke=({data:d,lang:u,isCheck:t,categories:_,setIsCheck:c,useParamId:T,showChild:j})=>{const{title:f,serviceId:C,handleModalOpen:I,handleUpdate:D}=be(),{showingTranslateValue:h}=re(),A=s=>{const{id:v,checked:N}=s.target;c([...t,v]),N||c(t.filter(g=>g!==v))};return e.jsxs(e.Fragment,{children:[(t==null?void 0:t.length)<1&&e.jsx(je,{useParamId:T,id:C,title:f}),e.jsx(Ne,{children:e.jsx(we,{id:C,data:d,lang:u})}),e.jsx(x.TableBody,{children:_==null?void 0:_.map(s=>{var v,N;return e.jsxs(x.TableRow,{children:[e.jsx(x.TableCell,{children:e.jsx(ue,{type:"checkbox",name:"category",id:s._id,handleClick:A,isChecked:t==null?void 0:t.includes(s._id)})}),e.jsx(x.TableCell,{className:"font-semibold uppercase text-xs",children:(v=s==null?void 0:s._id)==null?void 0:v.substring(20,24)}),e.jsx(x.TableCell,{children:s!=null&&s.icon?e.jsx(x.Avatar,{className:"hidden mr-3 md:block bg-gray-50 p-1",src:s==null?void 0:s.icon,alt:s==null?void 0:s.parent}):e.jsx(x.Avatar,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product",className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none"})}),e.jsx(x.TableCell,{className:"font-medium text-sm ",children:(s==null?void 0:s.children.length)>0?e.jsxs(se,{to:`/categories/${s==null?void 0:s._id}`,className:"text-blue-700",children:[h(s==null?void 0:s.name),e.jsx(e.Fragment,{children:j&&e.jsxs(e.Fragment,{children:[" ",e.jsx("div",{className:"pl-2 ",children:(N=s==null?void 0:s.children)==null?void 0:N.map(g=>e.jsx("div",{children:e.jsx(se,{to:`/categories/${g==null?void 0:g._id}`,className:"text-blue-700",children:e.jsxs("div",{className:"flex text-xs items-center  text-blue-800",children:[e.jsx("span",{className:" text-xs text-gray-500 pr-1",children:e.jsx(xe,{})}),e.jsx("span",{className:"text-gray-500",children:h(g.name)})]})})},g._id))})]})})]}):e.jsx("span",{children:h(s==null?void 0:s.name)})}),e.jsx(x.TableCell,{className:"text-sm",children:h(s==null?void 0:s.sub_title)}),e.jsx(x.TableCell,{className:"text-center",children:e.jsx(he,{id:s._id,category:!0,status:s.status})}),e.jsx(x.TableCell,{children:e.jsx(fe,{id:s==null?void 0:s._id,parent:s,isCheck:t,children:s==null?void 0:s.children,handleUpdate:D,handleModalOpen:I,title:h(s==null?void 0:s.name)})})]},s._id)})})]})};export{we as C,Ke as a};
