import{r as N,S as Z,u as y,j as e,d as c,L as z}from"./index-54596add.js";import{S as ee,I as se}from"./Layout-a33231f7.js";import{C as ae,S as le}from"./BulkActionDrawer-010f3b92.js";import{C as F,T as K,D as re,u as te,M as ne}from"./DrawerButton-d4950b3a.js";import{D as ie,E as de}from"./EditDeleteButton-8c9f62fe.js";import{T as oe}from"./ParentCategory-3924b7aa.js";import{a as O,n as Y}from"./toast-f90a3672.js";import{u as me,E as P}from"./index.esm-65e9c44c.js";import{I as R}from"./InputArea-c815a5c4.js";import{L as b}from"./LabelArea-ca83d841.js";import{T as ce,S as pe}from"./TextAreaCom-2778016f.js";import{U}from"./Uploader-b0a3570f.js";import{u as xe}from"./useTranslationValue-833ddc28.js";import{u as G}from"./useUtilsFunction-d4cebd2f.js";const ge=(i,p)=>{const{isDrawerOpen:r,closeDrawer:v,setIsUpdate:d,lang:w}=N.useContext(Z),[I,T]=N.useState({}),[o,x]=N.useState(""),[D,g]=N.useState(""),[A,s]=N.useState([]),[t,f]=N.useState(w),[m,_]=N.useState(!0),[E,L]=N.useState(""),[B,C]=N.useState(!1),{handlerTextTranslateHandler:H}=xe(),{register:l,handleSubmit:h,setValue:a,clearErrors:u,reset:k,formState:{errors:J}}=me(),Q=async({name:j,description:n})=>{var V,q;try{C(!0);const S=await H(j,t),X=await H(n,t),$={name:{[t]:j,...S},description:{[t]:n||"",...X},parentId:o||void 0,parentName:E||"Home",icon:D,status:m?"show":"hide",lang:t};if(i){const M=await F.updateCategory(i,$);d(!0),C(!1),Y(M.message),v(),k()}else{const M=await F.addCategory($);d(!0),C(!1),Y(M.message),v()}}catch(S){C(!1),O(S?(q=(V=S==null?void 0:S.response)==null?void 0:V.data)==null?void 0:q.message:S==null?void 0:S.message),v()}},W=j=>{f(j),Object.keys(I).length>0&&(a("name",I.name[j||"en"]),a("description",I.description[j||"en"]))};return N.useEffect(()=>{var j;if(!r){T({}),a("name"),a("parentId"),a("parentName"),a("description"),a("icon"),g(""),_(!0),u("name"),u("parentId"),u("parentName"),u("description"),L("Home"),f(w),a("language",t),p!==void 0&&((j=p[0])==null?void 0:j._id)!==void 0&&x(p[0]._id);return}i&&(async()=>{try{const n=await F.getCategoryById(i);n&&(T(n),a("name",n.name[t||"en"]),a("description",n.description[t||"en"]),a("language",t),a("parentId",n.parentId),a("parentName",n.parentName),L(n.parentName),x(n.parentId),g(n.icon),_(n.status==="show"))}catch(n){O(n?n.response.data.message:n.message)}})()},[i,a,r,t,u,p,w]),{register:l,handleSubmit:h,onSubmit:Q,errors:J,imageUrl:D,setImageUrl:g,children:A,setChildren:s,published:m,setPublished:_,checked:o,setChecked:x,isSubmitting:B,selectCategoryName:E,setSelectCategoryName:L,handleSelectLanguage:W}},he=({id:i,data:p})=>{const{t:r}=y(),{checked:v,register:d,onSubmit:w,handleSubmit:I,errors:T,imageUrl:o,setImageUrl:x,published:D,setPublished:g,setChecked:A,selectCategoryName:s,setSelectCategoryName:t,handleSelectLanguage:f,isSubmitting:m}=ge(i,p),{showingTranslateValue:_}=G(),E=`
  .rc-tree-child-tree {
    display: hidden;
  }
  .node-motion {
    transition: all .3s;
    overflow-y: hidden;
  }
`,L={motionName:"node-motion",motionAppear:!1,onAppearStart:l=>({height:0}),onAppearActive:l=>({height:l.scrollHeight}),onLeaveStart:l=>({height:l.offsetHeight}),onLeaveActive:()=>({height:0})},B=l=>{let h=[];for(let a of l)h.push({title:_(a.name),key:a._id,children:a.children.length>0&&B(a.children)});return h},C=(l,h)=>{var a;return l._id===h?l:(a=l==null?void 0:l.children)==null?void 0:a.reduce((u,k)=>u??C(k,h),void 0)},H=async l=>{if(l!==void 0)if(i){const h=await F.getCategoryById(l);if(i===l)return O("This can't be select as a parent category!");if(i===h.parentId)return O("This can't be select as a parent category!");{if(l===void 0)return;A(l);const a=p[0],u=C(a,l);t(_(u==null?void 0:u.name))}}else{if(l===void 0)return;A(l);const h=p[0],a=C(h,l);t(_(a==null?void 0:a.name))}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full relative p-6 border-b border-gray-100 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:i?e.jsx(K,{register:d,handleSelectLanguage:f,title:r("UpdateCategory"),description:r("UpdateCategoryDescription")}):e.jsx(K,{register:d,handleSelectLanguage:f,title:r("AddCategoryTitle"),description:r("AddCategoryDescription")})}),e.jsx(ee,{className:"w-full md:w-7/12 lg:w-8/12 xl:w-8/12 relative dark:bg-gray-700 dark:text-gray-200",children:e.jsxs("form",{onSubmit:I(w),children:[e.jsxs("div",{className:"p-6 flex-grow scrollbar-hide w-full max-h-full pb-40",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(b,{label:r("Name")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(R,{register:d,label:"Category title",name:"name",type:"text",placeholder:r("ParentCategoryPlaceholder")}),e.jsx(P,{errorName:T.name})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(b,{label:r("Description")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(ce,{required:!0,register:d,label:"Description",name:"description",type:"text",placeholder:"Category Description"}),e.jsx(P,{errorName:T.description})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(b,{label:r("ParentCategory")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4 relative",children:[e.jsx(c.Input,{readOnly:!0,...d("parent",{required:!1}),name:"parent",value:s||"Home",placeholder:r("ParentCategory"),type:"text"}),e.jsxs("div",{className:"draggable-demo capitalize",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:E}}),e.jsx(oe,{expandAction:"click",treeData:B(p),selectedKeys:[v],onSelect:l=>H(l[0]),motion:L,animation:"slide-up"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(b,{label:r("CategoryIcon")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(U,{imageUrl:o,setImageUrl:x,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(b,{label:"Testimonial One"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(U,{imageUrl:o,setImageUrl:x,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(b,{label:"Testimonial Two"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(U,{imageUrl:o,setImageUrl:x,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(b,{label:"Testimonial Three"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(U,{imageUrl:o,setImageUrl:x,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(b,{label:"Testimonial Four"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(U,{imageUrl:o,setImageUrl:x,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(b,{label:"Background Color"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(R,{register:d,label:"Background Color",name:"background_color",type:"text",placeholder:"Background Color"}),e.jsx(P,{errorName:T.background_color})]})]})," ",e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(b,{label:"Text Color"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(R,{register:d,label:"Text Color",name:"text_color",type:"text",placeholder:"Text Color"}),e.jsx(P,{errorName:T.text_color})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(b,{label:r("Published")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(pe,{handleProcess:g,processOption:D})})]})]}),e.jsx(re,{id:i,title:"Category",isSubmitting:m})]})})]})},Ee=({data:i,lang:p,isCheck:r,categories:v,setIsCheck:d,useParamId:w,showChild:I})=>{const{title:T,serviceId:o,handleModalOpen:x,handleUpdate:D}=te(),{showingTranslateValue:g}=G(),A=s=>{const{id:t,checked:f}=s.target;d([...r,t]),f||d(r.filter(m=>m!==t))};return e.jsxs(e.Fragment,{children:[(r==null?void 0:r.length)<1&&e.jsx(ie,{useParamId:w,id:o,title:T}),e.jsx(ne,{children:e.jsx(he,{id:o,data:i,lang:p})}),e.jsx(c.TableBody,{children:v==null?void 0:v.map(s=>{var t,f;return e.jsxs(c.TableRow,{children:[e.jsx(c.TableCell,{children:e.jsx(ae,{type:"checkbox",name:"category",id:s._id,handleClick:A,isChecked:r==null?void 0:r.includes(s._id)})}),e.jsx(c.TableCell,{className:"font-semibold uppercase text-xs",children:(t=s==null?void 0:s._id)==null?void 0:t.substring(20,24)}),e.jsx(c.TableCell,{children:s!=null&&s.icon?e.jsx(c.Avatar,{className:"hidden mr-3 md:block bg-gray-50 p-1",src:s==null?void 0:s.icon,alt:s==null?void 0:s.parent}):e.jsx(c.Avatar,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product",className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none"})}),e.jsx(c.TableCell,{className:"font-medium text-sm ",children:(s==null?void 0:s.children.length)>0?e.jsxs(z,{to:`/categories/${s==null?void 0:s._id}`,className:"text-blue-700",children:[g(s==null?void 0:s.name),e.jsx(e.Fragment,{children:I&&e.jsxs(e.Fragment,{children:[" ",e.jsx("div",{className:"pl-2 ",children:(f=s==null?void 0:s.children)==null?void 0:f.map(m=>e.jsx("div",{children:e.jsx(z,{to:`/categories/${m==null?void 0:m._id}`,className:"text-blue-700",children:e.jsxs("div",{className:"flex text-xs items-center  text-blue-800",children:[e.jsx("span",{className:" text-xs text-gray-500 pr-1",children:e.jsx(se,{})}),e.jsx("span",{className:"text-gray-500",children:g(m.name)})]})})},m._id))})]})})]}):e.jsx("span",{children:g(s==null?void 0:s.name)})}),e.jsx(c.TableCell,{className:"text-sm",children:g(s==null?void 0:s.description)}),e.jsx(c.TableCell,{className:"text-center",children:e.jsx(le,{id:s._id,category:!0,status:s.status})}),e.jsx(c.TableCell,{children:e.jsx(de,{id:s==null?void 0:s._id,parent:s,isCheck:r,children:s==null?void 0:s.children,handleUpdate:D,handleModalOpen:x,title:g(s==null?void 0:s.name)})})]},s._id)})})]})};export{he as C,Ee as a};
