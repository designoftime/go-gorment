import{d as p}from"./index-f507cea5.js";import{r as n,A as F,S as H,b as R,a as q}from"./index-1335bc53.js";import{u as z}from"./index.esm-c21e54b9.js";import{A as S}from"./AdminServices-8fc05990.js";import{n as A,a as C}from"./toast-96a71eb1.js";import{u as G}from"./useTranslationValue-ab99a2e2.js";const X=m=>{const{state:T}=n.useContext(F),{adminInfo:D}=T,{isDrawerOpen:d,closeDrawer:c,setIsUpdate:h,lang:w}=n.useContext(H),[Y,f]=n.useState(""),[u,y]=n.useState(p(new Date).format("YYYY-MM-DD")),[o,b]=n.useState(w||"en"),[x,j]=n.useState({}),[L,l]=n.useState(!1),I=R(),{handlerTextTranslateHandler:U}=G(),{register:O,handleSubmit:V,setValue:a,clearErrors:r,formState:{errors:k}}=z(),v=async t=>{var i,e;try{l(!0);const s=await U(t.name,o),E={name:{[o]:t.name,...s},email:t.email,password:t.password,phone:t.phone,role:t.role,joiningDate:u||p(new Date).format("YYYY-MM-DD"),image:Y,lang:o};if(m){const g=await S.updateStaff(m,E);h(!0),l(!1),A(g.message),c()}else{const g=await S.addStaff(E);h(!0),l(!1),A(g.message),c()}}catch(s){C(s?(e=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:e.message:s==null?void 0:s.message),l(!1),c()}},M=async()=>{var t,i;try{const e=await S.getStaffById(m,{email:D.email});e&&(j(e),a("name",e.name[o||"en"]),a("email",e.email),a("password"),a("phone",e.phone),a("role",e.role),y(p(e.joiningData).format("YYYY-MM-DD")),f(e.image))}catch(e){C(e?(i=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:i.message:e==null?void 0:e.message)}},B=t=>{b(t),Object.keys(x).length>0&&a("name",x.name[t||"en"])};return n.useEffect(()=>{if(!d){j({}),a("name"),a("email"),a("password"),a("phone"),a("role"),a("joiningDate"),f(""),r("name"),r("email"),r("password"),r("phone"),r("role"),r("joiningDate"),f(""),b(w),a("language",o);return}m&&M()},[m,a,d,D.email,r]),n.useEffect(()=>{I.pathname==="/edit-profile"&&q.get("adminInfo")&&M()},[I.pathname,a]),{register:O,handleSubmit:V,onSubmit:v,language:o,errors:k,setImageUrl:f,imageUrl:Y,selectedDate:u,setSelectedDate:y,isSubmitting:L,handleSelectLanguage:B}};export{X as u};
